class inherited МашинаРеквизитов.Базовые.интЗапись "Интерфейс заявления";

import СИС2 classes ФункцииРТТИ,ФункцииДокумента;


inclass public

  proc ИнициализироватьИнтерфейс synonym InitInterface;
    var локМетод : MethodInfo;
    var локПолнИмя : string;
      inherited InitInterface;
      локПолнИмя = "Бюджет_СоцСтрах.Документы.интЗаявление.ОчиститьДопДокументыПередУдалением";
      локМетод = ПолучитьИнфоМетодаПоПолномуИмениМетода(локПолнИмя);
      СобытиеПередУдалением.AddMethod(локМетод);
  end;


  func СвязанныйКлассЗаписей: class СИС2.Базовая.БазоваяЗапись;
    Result = Документы.Заявление;
  end;

  func Create: Документы.интЗаявление;
    Result = inherited Create;
    Result.Record = Документы.Заявление.Create;
  end;

  func ОткрытьПоЗаписи synonym OpenRecord (locRecord: Документы.Заявление): Документы.интЗаявление;
    Result = inherited Create;
    Result.Record = locRecord;
  end;

  func БланкРедакторПоУмолчанию: class BlankForm;
    Result = Документы.РедЗаявление;
  end;

  func КартотекаПоУмолчанию: class CardForm;
    Result = Документы.картЗаявление;
  end;


  func ОчиститьДопДокументыПередУдалением (локПарам: variant[]): logical;
    var локЗаявление: Документы.Заявление;
    Result = nil;
    локЗаявление = локПарам[2];
    if (локЗаявление = nil):
      return;
    fi;
    ОчиститьПоКлассуЗаписи (локЗаявление,Документы.ДополнительныеДокументы.Адрес);
    ОчиститьПоКлассуЗаписи (локЗаявление,Документы.ДополнительныеДокументы.ДокументОПроживании);
    ОчиститьПоКлассуЗаписи (локЗаявление,Документы.ДополнительныеДокументы.СвидетельствоОРождении);
    ОчиститьПоКлассуЗаписи (локЗаявление,Документы.ДополнительныеДокументы.Справка);
    ОчиститьПоКлассуЗаписи (локЗаявление,Документы.ДополнительныеДокументы.УдостоверениеЛичности);
  end;


inclass private


  proc ОчиститьПоКлассуЗаписи (локЗаявление: Документы.Заявление; локКлассЗаписи : Class Record);
    var Q: Query;
    Q = Query.Create([локКлассЗаписи]);
    Q.Filter = "Заявление=" + Str(локЗаявление);
    if not Q.RecordsExists:
      return;
    fi;
    Q.Select;
    СИС2.ФункцииДокумента.DeleteAllRecords(Q);
  end;


end