class inherited МашинаРеквизитов.Базовые.интЗаписьКодИмя "Интерфейс заявки на назначение пособий";

import classes Константы,ФункцииПримененияКостант;
import Бюджет_ЗПиДД classes Константы;


inclass public

  func СвязанныйКлассЗаписей: class СИС2.Базовая.БазоваяЗапись;
    Result = Данные.ЗаявкаНаНазначениеПособия;
  end;

  func Create: Данные.интЗаявкаНаНазначениеПособия;
    Result = inherited Create;
    Result.Record = Данные.ЗаявкаНаНазначениеПособия.Create;
  end;

  func ОткрытьПоЗаписи synonym OpenRecord (locRecord: Данные.ЗаявкаНаНазначениеПособия): Данные.интЗаявкаНаНазначениеПособия;
    Result = inherited Create;
    Result.Record = locRecord;
  end;

  func БланкРедакторПоУмолчанию: class BlankForm;
    Result = Данные.редЗаявкаНаНазначениеПособия;
  end;

  func КартотекаПоУмолчанию: class CardForm;
    Result = nil; --Данные.картБанкРеквизиты;
  end;

inobject public

  Record: Данные.ЗаявкаНаНазначениеПособия;

  --@doc При создании новой записи
proc ИнициализироватьПоУмолчанию synonym InitByDefault;
  inherited InitByDefault;
  Self.Record.Код = ТББ_Базовый.Нумератор.НовыйКод(Self.Record);
end;

  --@doc В массив ПараметрыНазначения записываются

proc НоваяЗаявка(локНазначение : Бюджет_ЗПиДД.РасчетныеОперации.НазначениеПособия);
  ИнициализироватьПоУмолчанию;
  if (локНазначение <> nil) :
    Self.Record.НашеУчреждение = локНазначение.НашеУчреждение;
    Self.Record.Сотрудник = локНазначение.Сотрудник;
    Self.Record.Сотрудник = локНазначение.Сотрудник;
    Self.Record.ТипПособия = локНазначение.ВидСтраховогоОбеспечения.ТипПособия;
    Self.Record.НазначениеПособия = локНазначение;
    if (локНазначение.ТипДокОснования = ДокументОснованиеПособия_Прочее) :
      ПрочиеДокументы(локНазначение);
    fi;

    Self.Record.Post;
  end;
end;


inobject private

proc ПрочиеДокументы(локНазначение : Бюджет_ЗПиДД.РасчетныеОперации.НазначениеПособия);
  var i : integer;
    i = Self.Record.ПрочиеДокументы.Add;
    Self.Record.ПрочиеДокументы[i].ДатаДок = локНазначение.ДатаДок;
    Self.Record.ПрочиеДокументы[i].ДатаНачалаДок = локНазначение.ДатаНачала;
    Self.Record.ПрочиеДокументы[i].ДатаОкончанияДок = локНазначение.ДатаОкончания;
    Self.Record.ПрочиеДокументы[i].НомерДок = локНазначение.НомерДок;
    Self.Record.ПрочиеДокументы[i].НаимДок = локНазначение.НаимДок;
end;

end