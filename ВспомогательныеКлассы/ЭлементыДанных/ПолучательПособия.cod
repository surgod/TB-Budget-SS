class "Получатель пособия";

import classes Константы,ФункцииЭлементовДанных;
import Базовый classes Константы;
import СИС2 classes Константы;

inclass public

  --@doc Конструктор: cоздание объекта по записи НашеУчреждение
func СоздатьПоЗаписиПолучателя (локПолучатель: Данные.ПолучательПособия) : ЭлементыДанных.ПолучательПособия;
  Result = inherited Create;
  Result.ПоляПоЗаписиПолучателя(локПолучатель);
end;

func СоздатьПоЗаписиСубъекта (локСубъект: Базовый.Данные.Субъект) : ЭлементыДанных.ПолучательПособия;
  Result = inherited Create;
  Result.ПоляПоЗаписиСубъекта(локСубъект);
end;



inobject public

func ЗаписьПолучателя : Данные.ПолучательПособия;
  return _ЗаписьПолучателя;
end;

func СтраховойСлучай : Данные.СтраховойСлучай;
  return _СтраховойСлучай;
end;

func Счетчик : integer;
  return _Счетчик;
end;

func Субъект : Базовый.Данные.Субъект;
  return _Субъект;
end;

func ФамилияПолучателя : string;
  return _ФамилияПолучателя;
end;

func ИмяПолучателя : string;
  return _ИмяПолучателя;
end;

func ОтчествоПолучателя : string;
  return _ОтчествоПолучателя;
end;

func ДатаРождения : date;
  return _ДатаРождения;
end;


func Телефон : string;
  return _Телефон;
end;

func АдресРегистрации : Базовый.Справочники.Адрес;
  return _АдресРегистрации;
end;

func АдресПроживания : Базовый.Справочники.Адрес;
  return _АдресПроживания;
end;

proc ЗапомнитьСтраховойСлучай(локСтраховойСлучай : Данные.СтраховойСлучай);
  _СтраховойСлучай = локСтраховойСлучай;
end;

func ОсновныеСведенияСтрокой : string;
  return ОсновныеСведенияВСтроку;
end;

func АдресРегистрацииСтрокой : string;
  Result = '';
  if (_ЗаписьПолучателя = nil) :
    return if(_АдресРегистрации_ФЛ <> nil : _АдресРегистрации_ФЛ.Адрес_Строкой , '' );
  else
    return if(_АдресРегистрации <> nil : _АдресРегистрации.Адрес_Строкой , '' );
  fi;
end;

func АдресПроживанияСтрокой : string;
  Result = '';
  if (_ЗаписьПолучателя = nil) :
    return if(_АдресПроживания_ФЛ <> nil : _АдресПроживания_ФЛ.Адрес_Строкой , '' );
  else
    return if(_АдресПроживания <> nil : _АдресПроживания.Адрес_Строкой , '' );
  fi;
end;


inobject private

_ЗаписьПолучателя : Данные.ПолучательПособия;
_СтраховойСлучай : Данные.СтраховойСлучай;
_Счетчик : integer;
_Субъект : Базовый.Данные.Субъект;
_ФамилияПолучателя : string;
_ИмяПолучателя : string;
_ОтчествоПолучателя : string;
_ДатаРождения : date;
_Телефон : string;
_АдресРегистрации   : Базовый.Справочники.Адрес;
_АдресПроживания  : Базовый.Справочники.Адрес;
_АдресРегистрации_ФЛ   : Базовый.Справочники.Адрес;
_АдресПроживания_ФЛ  : Базовый.Справочники.Адрес;

proc ПоляПоЗаписиПолучателя(локПолучатель: Данные.ПолучательПособия);
  _ЗаписьПолучателя = локПолучатель;
  _СтраховойСлучай = локПолучатель.СтраховойСлучай;
  _Счетчик = локПолучатель.Счетчик;
  _Субъект = локПолучатель.Субъект;
  _ФамилияПолучателя = локПолучатель.ФамилияПолучателя;
  _ИмяПолучателя  = локПолучатель.ИмяПолучателя;
  _ОтчествоПолучателя = локПолучатель.ОтчествоПолучателя;
  _ДатаРождения = локПолучатель.ДатаРождения;
  _Телефон = локПолучатель.Телефон;
  _АдресРегистрации = АдресПолучателяПоТипу(_ЗаписьПолучателя,тапПрописка);
  _АдресПроживания = АдресПолучателяПоТипу(_ЗаписьПолучателя,тапФактический);
  _АдресРегистрации_ФЛ  = nil;
  _АдресПроживания_ФЛ = nil;
end;

proc ПоляПоЗаписиСубъекта(локСубъект : Базовый.Данные.Субъект);
  var локФизЛицо : Базовый.Данные.Субъект;
    локФизЛицо = локСубъект.ФизЛицо;
    _ЗаписьПолучателя = nil;
    _СтраховойСлучай = nil;
    _Счетчик = 0;
    _Субъект = локСубъект;
    _ФамилияПолучателя = Базовый.ФункцииСубъекта.Фамилия_НаДату(локФизЛицо,Today,фсИменительныйЕдин);
    _ИмяПолучателя  = Базовый.ФункцииСубъекта.Имя_НаДату(локФизЛицо,Today,фсИменительныйЕдин);
    _ОтчествоПолучателя = Базовый.ФункцииСубъекта.Отчество_НаДату(локФизЛицо,Today,фсИменительныйЕдин);
    _ДатаРождения = локФизЛицо.ДатаРождения;
    _Телефон = локФизЛицо.Телефон;
    _АдресРегистрации = nil;
    _АдресПроживания = nil;
    _АдресРегистрации_ФЛ  = ТББ_Базовый.Библио.ПолучитьАдресСубъекта(локФизЛицо,Today);
    _АдресПроживания_ФЛ = nil;
end;

func ОсновныеСведенияВСтроку : string;
  Result = _ФамилияПолучателя + ' ' + _ИмяПолучателя;
  Result = Result + if(_ОтчествоПолучателя <> '' : ' ' + _ОтчествоПолучателя, '');
  Result = Result + if(_ДатаРождения <> nil  : ',дата рождения ' + Str(_ДатаРождения), '');
  Result = Result + if(_Телефон <> ''  : ', телефон ' + _Телефон, '');
end;




end