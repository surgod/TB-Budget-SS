class inherited “ЅЅ_Ѕазовый.Ѕазовые.ЅазовыйЅланкƒокумент "«а€вление об оплате пособи€ соц.страх.", editor ƒокументы.«а€вление;


import classes  онстанты;
import —»—2 classes  онстанты;

inobject private


--фреймы

var фреймЁкран : TemplateFrame;
var фреймЎаблоны : TemplateFrame;
var фреймѕечать : TemplateFrame;


--------------------------------------------------------------------------------
--{ ќбработчики событий бланка

proc шаблон_ѕриќткрытии (Create: Logical);
  inherited шаблон_ѕриќткрытии(Create);
end;



proc шаблон_ѕри—читывании;
  inherited шаблон_ѕри—читывании;
  ѕрочитать“ипыѕособий;
  ѕрочитать—пособ¬ыплаты;
  ¬ид‘ормы;
end;

 proc кнќбновить_ѕриЌажатии(B1: Button);
   var лок—убъект : Ѕазовый.ƒанные.—убъект;
    Ќаим“ќ‘—— = Ќаше”чреждение.Ќаимќргана‘——;
    if (—отрудник <> nil) :
      лок—убъект = —отрудник.‘изЋицо;
      ѕолное‘»ќ_‘Ћ_–од = Ѕазовый.‘ункции—убъекта.‘»ќ_Ќаƒату(лок—убъект,ToDay,фс–одительный≈дин);
      ‘амили€ = лок—убъект.‘амили€‘излица;
      »м€ = лок—убъект.»м€‘излица;
      ќтчество = лок—убъект.ќтчество‘излица;
    fi;
    ¬ид‘ормы;
 end;


--}


var ‘лагѕособи€ЅЋ : logical;
var ‘лагѕособи€Ѕерем : logical;
var ‘лагѕособи€–ан—рок : logical;
var ‘лагѕособи€–ожд : logical;
var ‘лагѕособи€”ход–еб : logical;
var ‘лагѕособи€“равма : logical;
var ‘лагѕособи€ќтпуск : logical;

var ‘лаг¬ыплатаЅанк : logical;
var ‘лаг¬ыплатаѕочта : logical;
var ‘лаг¬ыплата»ное : logical;



--{ ¬спомогательные методы

proc ѕрочитать“ипыѕособий;
  var i : integer;
    ‘лагѕособи€ЅЋ = false;
    ‘лагѕособи€Ѕерем = false;
    ‘лагѕособи€–ан—рок = false;
    ‘лагѕособи€–ожд = false;
    ‘лагѕособи€”ход–еб = false;
    ‘лагѕособи€“равма = false;
    ‘лагѕособи€ќтпуск = false;
    for i = 1.. Self.Record.“ипыѕособий.Count do
      if (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€ЅЋ) :
        ‘лагѕособи€ЅЋ = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€Ѕерем) :
        ‘лагѕособи€Ѕерем = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€–ан—рок) :
        ‘лагѕособи€–ан—рок = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€–ожд) :
        ‘лагѕособи€–ожд = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€”ход–еб) :
        ‘лагѕособи€”ход–еб = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€“равма) :
        ‘лагѕособи€“равма = true;
      elsif (Self.Record.“ипыѕособий[i].“ипѕособи€ = “ипѕособи€ќтпуск) :
        ‘лагѕособи€ќтпуск = true;
      fi;
    end;
end;

proc ѕрочитать—пособ¬ыплаты;
  ‘лаг¬ыплатаЅанк  = false;
  ‘лаг¬ыплатаѕочта  = false;
  ‘лаг¬ыплата»ное  = false;
  if (—пособ¬ыплаты = “ип¬ыплатаЅанк) :
    ‘лаг¬ыплатаЅанк  = true;
  elsif (—пособ¬ыплаты = “ип¬ыплатаѕочта) :
    ‘лаг¬ыплатаѕочта  = true;
  elsif (—пособ¬ыплаты = “ип¬ыплата»ное) :
    ‘лаг¬ыплата»ное  = true;
  fi;
end;



  proc ¬ид‘ормы;
    Template.BeginModify;
      «аполнитьЎаблоны—екций;
      —екцииЌаЁкран;
    Template.EndModify;
  end;

  proc «аполнитьЎаблоны—екций;
    «аполнитьЎапку;
  end;

  proc «аполнитьЎапку;
    var лок—екц : TemplateSection;
    var nstr[],nstb[], i, j, nn : integer;
    var ss,ss1: string;
      лок—екц = —екци€ѕо»мени('секцЎапка',фреймЎаблоны);
      nstr = Ќомера—трокѕо»менам(лок—екц,['стр_Ўапка_‘сс_Ќ','стр_Ўапка_‘сс_ ']);
      nstb = Ќомера—толбцовѕо»менам(лок—екц,['стб_Ўапка_Ќ','стб_Ўапка_ ']);
      if (0 in nstr) :
        return;
      fi;
      if (0 in nstb) :
        return;
      fi;
      nn = 0;
      ss = Up(Ќаим“ќ‘——);
      for i = nstr[1]..nstr[2] do
        for j = nstb[1]..nstb[2] do
          nn = nn + 1;
          if (Length(ss) < nn) :
            ss1 = '';
          else
            ss1 = Substr(ss,nn,1);
          fi;
          лок—екц.Cell[j,i].Contents = ss1;
        end;
      end;
      nstr = Ќомера—трокѕо»менам(лок—екц,['стр_Ўапка_‘»ќ_Ќ','стр_Ўапка_‘»ќ_ ']);
      if (0 in nstr) :
        return;
      fi;
      nn = 0;
      ss = Up(ѕолное‘»ќ_‘Ћ_–од);
      for i = nstr[1]..nstr[2] do
        for j = nstb[1]..nstb[2] do
          nn = nn + 1;
          if (Length(ss) < nn) :
            ss1 = '';
          else
            ss1 = Substr(ss,nn,1);
          fi;
          лок—екц.Cell[j,i].Contents = ss1;
        end;
      end;
  end;

  proc —екцииЌаЁкран;
    ”далить¬се—екции(фреймЁкран);
     лонировать—екцию(фреймЁкран,'секцЎапка',фреймЎаблоны);
     лонировать—екцию(фреймЁкран,'секц“екст«а€влени€',фреймЎаблоны);
     лонировать—екцию(фреймЁкран,'секц—писокѕособий',фреймЎаблоны);
     лонировать—екцию(фреймЁкран,'секц—пособќплаты',фреймЎаблоны);
     лонировать—екцию(фреймЁкран,'секц оммент_—тр1',фреймЎаблоны);
  end;




--}

func ѕоле_ѕри¬ыводе_«аголовокќкна‘ормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
  var aTxt: string[];
  with —»—2.—троковые‘ункции  do
    aTxt[1] = MarkInGray(Ќаше”чреждение.Ќаим);
    aTxt[2] = '«а€вление на оплату пособи€ соц. страх. N '+ЌомерЅум;
    if (ƒата <> nil) :
      aTxt[2] = aTxt[2] + ' от '+Str(ƒата);
    fi;
    if (—отрудник <> nil) :
      aTxt[3] = MarkInGray(—отрудник.»м€);
    else
      aTxt[3] = '<s-><s->' ;
    fi;
    Return ћассив—трок¬“екст(aTxt);
  end;
end;





end