class inherited МашинаРеквизитов.Базовые.блРедакторСИнтерфейсомКодИмя "Настройка типа пособия для вида страхового обеспечения", editor Настройки.Справочники.ТипПособияДляВидаСО;

import classes Константы, ФункцииПримененияКостант;

inobject  private

--{{ Свойства

  var фреймНастройка: TemplateFrame;
  var ВидСО: Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
--}}

-- Обработчики событий шаблона

  proc шаблон_ПриСоздании(Context: Variant);
    inherited шаблон_ПриСоздании(Context);
    ОбновитьСписокПоля(Template.CellByField['ТипПособияСоцСтрах'], ТипыПособий);
    Self.Window.Caption = 'Настройка';
  end;

  proc шаблон_ПриСчитывании;
    inherited шаблон_ПриСчитывании;
    if (Код <> ''):
      ВидСО = НайтиВидСО;
    fi;
  end;

-- Обработчики событий клеток шаблона

  func Поле_ПриВходе (Cell: TemplateCell; Index: Integer; Action: Template.EnterTypes) :Logical;
    var локВидСО: Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    if (Cell.Contents = 'Код') :
      if (CmOk = Бюджет_ЗПиДД.Справочники.картВидыСтраховогоОбеспечения.ВыполнитьВыбор(локВидСО)):
        Код = локВидСО.Код;
        ВидСО = локВидСО;
      fi;
    fi;
  end;

-- Вспомогательные методы

  func НайтиВидСО :Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    var локФильтр :string;
    var локВидСО :Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    if (Код <> '') :
      локФильтр = 'Код="' + Код +'"';
      локВидСО = СИС2.ФункцииДокумента.QueryLastRecord(Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения, локФильтр);
      if (локВидСО <> nil) :
        Return локВидСО;
      fi;
    fi;
  end;

  func Поле_ПриВыводе_ЗаголовокОкнаФормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
    var aTxt: string[];
    with СИС2.СтроковыеФункции  do
      aTxt[1] = MarkInGray('Дополнительная настройка вида страхового обеспечения');
      aTxt[2] = ИмяТипаПособия(ТипПособияСоцСтрах);
      --aTxt[2] = 'Код вида страхового обеспечения ' + if((Код<>''): Код, 'не указан');
      --aTxt[3] = 'Тип пособия по социальному страхованию ' + ИмяТипаПособия(ТипПособияСоцСтрах);
      Return МассивСтрокВТекст(aTxt);
    end;
  end;


end