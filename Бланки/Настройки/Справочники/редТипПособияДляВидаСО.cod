class inherited СИС2.БазовыйБланкРедактор "Редактор настройки типа пособия для вида страх.обеспечения", editor Настройки.Справочники.ТипПособияДляВидаСО;

import classes Константы,ФункцииПримененияКостант;



inobject  private

  var фреймНастройка :TemplateFrame;

  var ВидСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;

--------------------------------------------------------------------------------
--{ Обработчики событий бланка

proc шаблон_ПриСоздании(Context :Variant);
  inherited шаблон_ПриСоздании(Context);
  ОбновитьСписокПоля(Template.CellByField['ТипПособияСоцСтрах'], ТипыПособий);
end;

proc шаблон_ПриСчитывании;
  if (Код <> '') :
    ВидСО = НайтиВидСО;
  fi;
end;

func Поле_ПриВходе (Cell: TemplateCell; Index: Integer; Action: Template.EnterTypes): Logical;
  var локВидСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
  var locCrd : Бюджет_ЗПиДД.Справочники.картВидыСтраховогоОбеспечения;
    Result = false;
    if (Cell.Contents = 'Код') :
      locCrd = Бюджет_ЗПиДД.Справочники.картВидыСтраховогоОбеспечения.Create;
      if (CmOk = locCrd.ShowEx(локВидСО, , Kernel.Window.ModalWindow)):
        Код = локВидСО.Код;
        ВидСО = локВидСО;
      fi;
    fi;
end;
--}

--{ Вспомогательные методы
func НайтиВидСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
  var локФильтр : string;
  var локВидСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    Result = nil;
    if (Код <> '') :
      локФильтр = 'Код="' + Код +'"';
      локВидСО = СИС2.ФункцииДокумента.QueryLastRecord(Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения,локФильтр);
      if (локВидСО <> nil) :
         Result = локВидСО;
      fi;
    fi;
end;
--}


func Поле_ПриВыводе_ЗаголовокОкнаФормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
  var aTxt: string[];
  with СИС2.СтроковыеФункции  do
    aTxt[1] = MarkInGray('Дополнительная настройка вида страхового обеспечения для соц.страх.');
    aTxt[2] = 'Код вида страх.обеспечения ' + if(Код<> '' : Код, 'не указан');
    aTxt[3] = 'Тип пособия соц.страх. ' + ИмяТипаПособия(ТипПособияСоцСтрах);
    Return МассивСтрокВТекст(aTxt);
  end;
end;



end