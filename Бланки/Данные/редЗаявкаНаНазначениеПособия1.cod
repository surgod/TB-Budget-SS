class inherited “ЅЅ_Ѕазовый.Ѕазовые.ЅазовыйЅланкƒокумент "«а€вка на назначение и оплату пособи€", editor ƒанные.«а€вкаЌаЌазначениеѕособи€;

import classes  онстанты,‘ункцииѕрименени€ остант;--,‘ункцииƒанных;
import —»—2 classes  онстанты;
import Ѕазовый classes  онстанты;

--{{ —войства
inobject public

  var »нтерфейс: ƒанные.инт«а€вкаЌаЌазначениеѕособи€;

inobject private

  -- фреймы
  var фрейм—остав‘ормы :TemplateFrame;
  var фрейм—одержание :TemplateFrame;
  var фреймќсновные—ведени€1 :TemplateFrame;
  var фреймѕолучатель1 :TemplateFrame;
  var фреймƒокументыѕолучател€1 :TemplateFrame;
  var фрейм—ведени€ЅЋ1 :TemplateFrame;
  var фрейм–асчетЅЋ1 :TemplateFrame;
  var фрейм¬ыплата1 :TemplateFrame;

  -- иконки

  type typeIcon = (iEdit = 1, iEdit_Disabled, iReport, iMan, iDokMan, iInput, iCalc, iCalc_Disabled, iMoney);
  var ImageLibr: Image[]; -- локальна€ библиотека изображений
  type typeSpCell = (cMenuAddr = 1, cMenuIdCard, cMenuCert);
  var CellLibr: TemplateCell[]; -- локальна€ (дл€ экземпл€ра) библиотека клеток

  -- сведени€ о за€вке

  var Ќомер–еестра: string = if(ѕозици€–еестра <> nil, Str(ѕозици€–еестра.–еестр.Ќомер«аƒень), '');
  var ¬ид—ќ: Ѕюджет_«ѕиƒƒ.—правочники.¬иды—траховогоќбеспечени€;

  var ѕозици€–еестра: ƒокументы.‘——.ѕозици€–еестра; -- определ€етс€ при считывании
  var «аголовок«а€вки: string;

  -- интерфейсы св€занных записей

  var »нтјдрес–егистрации :  —правочники.интјдрес—оц—трах;
  var »нтјдресѕроживани€ :  —правочники.интјдрес—оц—трах;
  var »нт”достоверениеЋичности :  —правочники.инт”достоверение—оц—трах;
  var »нтƒокументќѕроживании :  —правочники.инт”достоверение—оц—трах;

  var »нт—ведени€ : variant;
  var »нт–асчет : variant;

  --пол€ дл€ редактироавни€ сведений дл€ назначени€ пособи€

  var “ип‘ормыЅЋ : integer;
  var ƒатаЅЋ : date;
  var ƒата—тационар1ЅЋ : date;
  var ƒата—тационар2ЅЋ : date;
  var ƒатаЌачалаЅЋ : date;
  var ƒатаќкончани€ЅЋ : date;
  var ƒата¬ыходаЌа–аботу : date;
  var ƒата–егистрации¬_ћ—Ё : date;

--}}


-- _ онструкторы, визуализаторы. --

-- _ќбработчики событий шаблона. --

proc шаблон_ѕри—оздании(Context: Variant);
  inherited шаблон_ѕри—оздании(Context);
  »нициализировать летки√ипер—сылок;
  «агрузить»конки;
  »нициализировать»конки‘реймов;
  ќбновить—писокѕол€(Template.FrameByName['фрейм¬ыплата1'].CellByField['—пособ¬ыплаты'], “ипы—пособов¬ыплаты‘Ћ);
  ќбновить—писокѕол€(Template.FrameByName['фреймќсновные—ведени€1'].CellByField['“ип»нфо'], “ипы»нфо);
  ќбновить—писокѕол€(Template.FrameByName['фреймќсновные—ведени€1'].CellByField['ѕричинаѕерерасчета'], “ипыѕричиныѕерерасчета);
end;

proc шаблон_ѕри—читывании;
  inherited шаблон_ѕри—читывании;
  ѕрочитатьѕозицию–еестра;
  ¬ид—ќ = Ќазначениеѕособи€.¬ид—траховогоќбеспечени€;
  if (Self.Record.State = Record.Created):
    »нтерфейс.Post;
    »нтерфейс.—оздать—в€занные«аписи;
  fi;
  ”становить»нтерфейсы—в€занных«аписей;
  «аполнить«аголовок«а€вки;
end;

func шаблон_ѕри«аписи: logical;
  Result = true;
  if (»нт—ведени€ <> nil) :
    »нт—ведени€.Record.Edit;
    if (»нт—ведени€.Record.Modified) :
      »нт—ведени€.Record.Post;
    fi;
  fi;
end;

func шаблон_ѕриќтмене : logical;
  Result = true;
  if (»нт—ведени€ <> nil) :
    if (»нт—ведени€.Record.Modified) :
      »нт—ведени€.Record.Cancel;
      »нт—ведени€.Record.Edit;
    fi;
  fi;
end;

-- _ќбработчики событий клеток шаблона. --

  proc ѕоле_ѕри–исовании (Cell: TemplateCell; Selected: Logical; var Color: Integer; var FieldColor: Integer; Font: Font);
    if (Cell.Style.Name = 'ѕоле ввода'):
      if Cell.Enabled: inherited ѕри–исовании_ акѕоле¬вода (Cell, Selected, Color, FieldColor, Font);
      else             inherited ѕри–исовании_ ак«апрещенное (Cell, Selected, Color, FieldColor, Font);
      fi;
    elsif (Cell.Style.Name = 'ѕоле выбора'):
      if Cell.Enabled: inherited ѕри–исовании_ акѕоле¬ыбора (Cell, Selected, Color, FieldColor, Font);
      else             inherited ѕри–исовании_ ак«апрещенное (Cell, Selected, Color, FieldColor, Font);
      fi;
    fi;
  end;

  func ѕоле_ѕри¬ыводе_«аголовокќкна‘ормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
    var aTxt: string[];
    with —»—2.—троковые‘ункции  do
      aTxt[1] = MarkInGray(Ќаше”чреждение.Ќаим);
      aTxt[2] = —отрудник.»м€;
      aTxt[3] = '<b->' + MarkInItalic(«аголовок«а€вки);
      if «авершен:
        aTxt[3] = MarkInMaroon(aTxt[3]);
      fi;
      Return ћассив—трок¬“екст(aTxt);
    end;
  end;

-- ќсновные сведени€ --

  func ќсновные—ведени€_ѕри¬ыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (Cell.Contents = '»м€“ипаѕособи€'):
      Return »м€“ипаѕособи€(“ипѕособи€);
    elsif (Cell.Contents = '»м€“ипаѕособи€ƒоп'):
      Return »м€“ипаѕособи€(“ипѕособи€ƒоп);
    elsif (Cell.Contents = '»м€“ипа–еестра'):
      Return ѕолное»м€“ипа–еестра(“ип–еестра);
    elsif (Cell.Contents = '¬ид—ќ_ƒоп'):
      if (Ќазначениеѕособи€ƒоп <> nil):
        Return Ќазначениеѕособи€ƒоп.¬ид—траховогоќбеспечени€.Ќаим;
      fi;
    fi;
  end;

  proc ќсновные—ведени€_ѕри¬ыходе (Cell: TemplateCell; Index: Integer);
    if (Cell.Contents = 'ЌомерЅум'):
      inherited ѕоле_ѕри¬ыходе(Cell, Index);
      «аполнить«аголовок«а€вки;
    fi;
  end;

-- —ведени€ о получателе пособи€  --

  func ѕолејдрес_ѕриЌажатии (Cell: TemplateCell; Action: Template.ClickTypes): Logical;
    ћенюјдреса;
  end;

  func ѕолејдрес_ѕри¬ыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (Cell.Contents = 'јдрес–ег_—трокой'):
      if (»нтјдрес–егистрации <> nil):
        Return »нтјдрес–егистрации.јдрес—трокой;
      fi;
    elsif (Cell.Contents = 'јдресѕрож_—трокой'):
      if (»нтјдресѕроживани€ <> nil):
        Return »нтјдресѕроживани€.јдрес—трокой;
      fi;
    fi;
  end;

  -- ƒокументы получател€ пособи€ --

  func ѕолеƒокументыѕолучател€_ѕриЌажатии (Cell: TemplateCell; Action: Template.ClickTypes): Logical;
    if (CellRow(Cell).Caption = '”достоверение личности'):
      ќткрыть”достоверени€Ћичности;
    elsif (CellRow(Cell).Caption = 'ƒокумент проживани€'):
      ћенюƒокументаќѕроживании;
    fi;
  end;

  func ѕолеƒокументыѕолучател€_ѕри¬ыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (Cell.Contents in ['—ери€_”дЋичн','Ќомер_”дЋичн','ƒата¬ыдачи_”дЋичн']):
      if (»нт”достоверениеЋичности <> nil) :
        if (Cell.Contents = '—ери€_”дЋичн'):
          Return »нт”достоверениеЋичности.—ери€ƒокумента;
        elsif (Cell.Contents = 'Ќомер_”дЋичн'):
          Return »нт”достоверениеЋичности.Ќомерƒокумента;
        elsif (Cell.Contents = 'ƒата¬ыдачи_”дЋичн'):
          Return »нт”достоверениеЋичности.ƒата¬ыдачиƒокумента;
        fi;
      fi;
    elsif (Cell.Contents in ['Ќаимƒок_ƒокѕрож','—ери€Ќомер_ƒокѕрож','ƒата¬ыдачи_ƒокѕрож']):
      if (»нтƒокументќѕроживании <> nil):
        if (Cell.Contents = 'Ќаимƒок_ƒокѕрож'):
          Return »нтƒокументќѕроживании.Ќаименованиеƒокумента;
        elsif (Cell.Contents = '—ери€Ќомер_ƒокѕрож'):
          Return »нтƒокументќѕроживании.—ери€Ќомер_–еестр;
        elsif (Cell.Contents = 'ƒата¬ыдачи_ƒокѕрож'):
          Return »нтƒокументќѕроживании.ƒата¬ыдачиƒокумента;
        fi;
      fi;
    fi;
  end;

  -- —ведени€ дл€ назначени€ пособи€ --

  func ѕоле—ведени€ЅЋ_ѕри¬ходе (Cell: TemplateCell; Index: Integer; Action: Template.EnterTypes): Logical;
    if (»нт—ведени€ <> nil):
      EditorPost;
      ƒанные.ред—ведени€–еестраЅЋ.ѕоказатьћодально(»нт—ведени€.Record, Cell.Contents, «авершен);
    fi;
  end;

  func ѕоле—ведени€ЅЋ_ѕри¬ыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (»нт—ведени€ <> nil):
      Return »нт—ведени€.ѕоле–едактораѕри¬ыводе(Cell.Contents);
    fi;
  end;

  -- —ведени€ дл€ расчета пособи€ --

  func ѕоле–асчетЅЋ_ѕри¬ходе (Cell: TemplateCell; Index: Integer; Action: Template.EnterTypes): Logical;
    if (»нт–асчет <> nil):
      EditorPost;
      ƒанные.ред–асчет–еестраЅЋ.ѕоказатьћодально(»нт–асчет.Record, Cell.Contents, «авершен);
    fi;
  end;

  func ѕоле–асчетЅЋ_ѕри¬ыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (»нт–асчет <> nil):
      Return »нт–асчет.ѕоле–едактораѕри¬ыводе(Cell.Contents);
    fi;
  end;

  -- —ведени€ дл€ выплаты пособи€ --

  func ѕоле¬ыплата_ѕри¬ходе(Cell :TemplateCell; Index :Integer; Action : Template.EnterTypes) :Logical;
    var locForm: BlankForm;
    var лок—трока: string;
    if (Cell.Contents = '—четѕолучател€') :
      лок—трока = —четѕолучател€;
      if ( cmOk = “ЅЅ_Ѕазовый.Ѕиблио.¬водЌомераЅанк—чета(лок—трока)) :
        —четѕолучател€ = лок—трока;
      fi;
    elsif (Cell.Contents = 'Ѕ» ') :
      лок—трока = Ѕ» ;
      if ( cmOk = “ЅЅ_Ѕазовый.Ѕиблио.¬водЌомераЅик(лок—трока)) :
        Ѕ»  = лок—трока;
      fi;
    elsif (Cell.Contents = 'Ќомер арты') :
      locForm = Ѕюджет_«ѕиƒƒ.—лужебные.бл¬водЌомераЅанк арты.CreateEx(Ќомер арты);
      if (cmOk = locForm.ShowEx( ,Window.ModalWindow)):
        Ќомер арты = locForm.ЌомерЅанк арты as String;
      fi;
    fi;
  end;


-- _ќбработчики событий прочих объектов шаблона. --

  proc фл«авершен_ѕриЌажатии (Sender: CheckBox);
    var Note: string;
    if (ѕозици€–еестра <> nil):
      if «авершен:
        ћодифицировать‘рейм_ нопки;
        Note = 'Ќельз€ сн€ть с за€вки признак завершени€, так как она включена в реестр';
        DisplayMessage(Note);
      else
        —»—2.‘ункцииƒокумента.RecordModify(Self.Record);
        «авершен = true;
        ћодифицироватьЎаблонƒоп;
      fi;
    else
      —»—2.‘ункцииƒокумента.RecordModify(Self.Record);
      «авершен = not «авершен;
      ћодифицироватьЎаблонƒоп;
    fi;
  end;

  proc кн¬–еестр_ѕриЌажатии (Sender: Button);
  end;

-- _ƒополнительные команды. --

-- _¬спомогательные методы. --

  proc ѕрочитатьѕозицию–еестра;
    ѕозици€–еестра = »нтерфейс.Ќайтиѕозицию–еестра;
  end;

  proc ”становить»нтерфейсы—в€занных«аписей;
    »нтјдрес–егистрации = —правочники.интјдрес—оц—трах.ќткрытьѕо«а€вке»“ипу(Self.Record,тапѕрописка);
    »нтјдресѕроживани€ = —правочники.интјдрес—оц—трах.ќткрытьѕо«а€вке»“ипу(Self.Record,тап‘актический);
    »нт”достоверениеЋичности = —правочники.инт”достоверение—оц—трах.ќткрытьѕо«а€вке»“ипу(Self.Record,“ипƒокѕолуч”дЋичности);
    »нтƒокументќѕроживании = —правочники.инт”достоверение—оц—трах.ќткрытьѕо«а€вке»“ипу(Self.Record,“ипƒокѕолучѕроживание);
    »нт—ведени€ = nil;
    »нт–асчет = nil;
    if (Self.Record.“ип–еестра = “ип–еестраЌѕ_ЅЋ) :
      »нт—ведени€ = ƒанные.инт—ведени€–еестраЅЋ.ќткрытьѕо«а€вке(Self.Record);
      »нт–асчет = ƒанные.инт–асчет–еестраЅЋ.ќткрытьѕо«а€вке(Self.Record);
    fi;
  end;

  proc «агрузитьѕол€—ведений;
    if (Self.Record.“ип–еестра in [“ипѕособи€ЅЋ,“ипѕособи€Ѕерем]) and (»нт—ведени€ <> nil):
      »нт—ведени€.«агрузитьѕол€¬–едактор«а€вки(Self);
    fi;
  end;

  proc «аполнить«аголовок«а€вки;
    «аголовок«а€вки = '«а€вка є '+ if(ЌомерЅум <> nil, ЌомерЅум, 'б/н');
    if (ѕозици€–еестра <> nil) :
      «аголовок«а€вки = «аголовок«а€вки + ', включена в реестр є ' + if(ѕозици€–еестра.–еестр.–егЌомер‘—— <> nil, ѕозици€–еестра.–еестр.–егЌомер‘——, 'б/н') + '.';
    else
      «аголовок«а€вки = «аголовок«а€вки + '.';
    fi;
  end;

  -- ”правление изображени€ми --

  proc »нициализировать летки√ипер—сылок;
    var locSection: TemplateSection;
    locSection = SectionByName('секцѕолучатель1');
    CellLibr[cMenuAddr] = SectionCellByContents(locSection, 'ћеню');
    locSection = SectionByName('секцƒокѕолучател€1');
    CellLibr[cMenuIdCard] = SectionCellByContents(locSection, 'ћеню');
    locSection = SectionByName('секцƒокѕолучател€2');
    CellLibr[cMenuCert] = SectionCellByContents(locSection, 'ћеню');
  end;

  proc «агрузить»конки;
    ImageLibr[iEdit] = Image.Create;
    ImageLibr[iEdit].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\32\Edit.ico');
    ImageLibr[iEdit_Disabled] = Image.Create;
    ImageLibr[iEdit_Disabled].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\32\EditDisabled.ico');
    ImageLibr[iReport] = Image.Create;
    ImageLibr[iReport].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\32\information.ico');
    ImageLibr[iMan] = Image.Create;
    ImageLibr[iMan].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\Ѕизнесмен.ico');
    ImageLibr[iDokMan] = Image.Create;
    ImageLibr[iDokMan].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\ ниги.ico');
    ImageLibr[iInput] = Image.Create;
    ImageLibr[iInput].LoadFromFile('%Projects%\“ЅЅ_Ѕазовый\ѕриложени€\»конки\—правка.ico');
    ImageLibr[iCalc] = Image.Create;
    ImageLibr[iCalc].LoadFromFile('%Projects%\Ѕюджет_«ѕиƒƒ\ѕриложени€\»конки\32\calc.ico');
    ImageLibr[iCalc_Disabled] = Image.Create;
    ImageLibr[iCalc_Disabled].LoadFromFile('%Projects%\Ѕюджет_«ѕиƒƒ\ѕриложени€\»конки\32\calc_disabled.ico');
    ImageLibr[iMoney] = Image.Create;
    ImageLibr[iMoney].LoadFromFile('%Projects%\Ѕюджет_«ѕиƒƒ\ѕриложени€\»конки\¬ыплаты.ico');
  end;

  proc »нициализировать»конки‘реймов;
    фрейм«акладки.Image = ImageLibr[iEdit];
    фреймќсновные—ведени€1.Image = ImageLibr[iReport];
    фреймѕолучатель1.Image = ImageLibr[iMan];
    фреймƒокументыѕолучател€1.Image = ImageLibr[iDokMan];
    фрейм—ведени€ЅЋ1.Image = ImageLibr[iInput];
    фрейм–асчетЅЋ1.Image = ImageLibr[iCalc];
    фрейм¬ыплата1.Image = ImageLibr[iMoney];
  end;

  proc »нициализировать»конкиѕолучатель;
    if «авершен:
      »нициализировать»конку летки(cMenuAddr, iEdit_Disabled);
    else
      »нициализировать»конку летки(cMenuAddr, iEdit);
    fi;
  end;

  proc »нициализировать»конкиƒокументыѕолучател€;
    if «авершен:
      »нициализировать»конку летки(cMenuIdCard, iEdit_Disabled);
      »нициализировать»конку летки(cMenuCert, iEdit_Disabled);
    else
      »нициализировать»конку летки(cMenuIdCard, iEdit);
      »нициализировать»конку летки(cMenuCert, iEdit);
    fi;
  end;

  proc »нициализировать»конку летки (iCell: typeSpCell; iIco: typeIcon);
    var locCell: TemplateCell;
    locCell = CellLibr[iCell];
    if (locCell <> nil):
      locCell.Image = Image.Create;
      locCell.ImageAlign = Template.AlignClient;
      locCell.ImageWithText = true;
      locCell.Contents = '';
      locCell.Image.Assign(ImageLibr[iIco]);
    fi;
  end;

  -- ”правление GUI --

  proc ћодифицироватьЎаблон (Ўаблонћодифицирован: Logical = false);
    Template.BeginModify;
      ћодифицировать‘рейм_ нопки;
      ћодифицировать‘рейм_ќсновные—ведени€;
      ћодифицировать‘рейм_ѕолучатель;
      ћодифицировать‘рейм_ƒокументыѕолучател€;
      ћодифицировать‘рейм_—ведени€ЅЋ;
      ћодифицировать‘рейм_–асчетЅЋ;
      ћодифицировать‘рейм_¬ыплата;
      if (Self.Record.“ип–еестра in [“ипѕособи€ЅЋ,“ипѕособи€Ѕерем]):
        фрейм—ведени€ЅЋ1.Caption = '—ведени€ дл€ назначени€ пособи€';
        фрейм–асчетЅЋ1.Caption = '—ведени€ дл€ расчета пособи€';
      else
        фрейм—ведени€ЅЋ1.Caption = '';
        фрейм–асчетЅЋ1.Caption = '';
      fi;
    Template.EndModify;
    inherited ћодифицироватьЎаблон(true); -- раскраска
  end;

  proc ћодифицировать‘рейм_ нопки;
    фл«авершен.State = Self.Record.«авершен;
  end;

  proc ћодифицировать‘рейм_ќсновные—ведени€;
    «апретитьƒоступ  леткам‘рейма(фреймќсновные—ведени€1, not «авершен);
  end;

  proc ћодифицировать‘рейм_ѕолучатель;
    «апретитьƒоступ  леткам‘рейма(фреймѕолучатель1, not «авершен);
    CellLibr[cMenuAddr].Enabled = not «авершен;
    »нициализировать»конкиѕолучатель;
  end;

  proc ћодифицировать‘рейм_ƒокументыѕолучател€;
    «апретитьƒоступ  леткам‘рейма(фреймƒокументыѕолучател€1, not «авершен);
    CellLibr[cMenuIdCard].Enabled = not «авершен;
    CellLibr[cMenuCert].Enabled = not «авершен;
    »нициализировать»конкиƒокументыѕолучател€;
  end;

  proc ћодифицировать‘рейм_—ведени€ЅЋ;
    «апретитьƒоступ  леткам‘рейма(фрейм—ведени€ЅЋ1, not «авершен);
  end;

  proc ћодифицировать‘рейм_–асчетЅЋ;
    «апретитьƒоступ  леткам‘рейма(фрейм–асчетЅЋ1, not «авершен);
  end;

  proc ћодифицировать‘рейм_¬ыплата;
    «апретитьƒоступ  леткам‘рейма(фрейм¬ыплата1, not «авершен);
  end;

  proc ќформитьЌавигатор (тблЌавигатор: Grid);
    inherited ќформитьЌавигатор(тблЌавигатор);
    тблЌавигатор.ShowIcons = true;
  end;

  --

  proc ћенюјдреса;
    var locValuePosition: variant[];
    var p: integer;
    var лок»нт: —правочники.интјдрес—оц—трах;
    var локјдрес: Ѕазовый.—правочники.јдрес;
    locValuePosition[1] = 'ќткрыть адрес регистрации';
    locValuePosition[2] = 'ќткрыть адрес проживани€';
    if (»нтјдресѕроживани€ <> nil) :
      locValuePosition[3] = '”далить адрес проживани€';
    elsif (»нтјдрес–егистрации <> nil and »нтјдресѕроживани€ = nil) :
      locValuePosition[3] = ' опировать адрес регистрации в адрес проживани€';
    fi;
    p = PopupMenu(locValuePosition);
    if (p = 1):
      лок»нт = »нтјдрес–егистрации;
      –едактироватьјдрес(лок»нт,тапѕрописка);
      »нтјдрес–егистрации = лок»нт;
    elsif (p = 2):
      лок»нт = »нтјдресѕроживани€;
      –едактироватьјдрес(лок»нт,тап‘актический);
      »нтјдресѕроживани€ = лок»нт;
    elsif (p = 3):
      if (locValuePosition[3] = '”далить адрес проживани€') :
        локјдрес = »нтјдресѕроживани€.Record;
        »нтјдресѕроживани€ = nil;
        локјдрес.Delete;
      elsif (locValuePosition[3] = ' опировать адрес регистрации в адрес проживани€') :
        локјдрес = »нтјдрес–егистрации.Record;
        лок»нт = —правочники.интјдрес—оц—трах.—оздать опиюƒл€«а€вки»“ипа(локјдрес,Self.Record,тап‘актический);
        лок»нт.Record.Post;
        »нтјдресѕроживани€ = лок»нт;
      fi;
    fi;
  end;

  proc –едактироватьјдрес (var лок»нт: —правочники.интјдрес—оц—трах; лок“ипјдреса: integer);
    var локјдрес: Ѕазовый.—правочники.јдрес;
    if (лок»нт = nil):
      лок»нт = —правочники.интјдрес—оц—трах.—оздатьѕо«а€вке»“ипу(Self.Record,лок“ипјдреса);
    fi;
    локјдрес = лок»нт.Record;
    —правочники.интјдрес—оц—трах.Ѕланк–едакторѕо”молчанию.ShowFormEx(локјдрес , Kernel.Window.ModalWindow);
    локјдрес = —правочники.интјдрес—оц—трах.Ќайтијдресѕо«а€вке»“ипу(Self.Record,лок“ипјдреса);
    if (локјдрес = nil) :
      лок»нт = nil;
    else
      лок»нт.Record = локјдрес;
    fi;
  end;

  proc ќткрыть”достоверени€Ћичности;
    var лок»нт: —правочники.инт”достоверение—оц—трах;
    лок»нт = »нт”достоверениеЋичности;
    –едактироватьƒокѕолучател€(лок»нт,“ипƒокѕолуч”дЋичности);
    »нт”достоверениеЋичности = лок»нт;
  end;

  proc ћенюƒокументаќѕроживании;
    var locValuePosition: variant[];
    var p: integer;
    var лок»нт: —правочники.инт”достоверение—оц—трах;
    var локƒокумент: Ѕазовый.—правочники.”достоверение;
    if (»нтƒокументќѕроживании = nil):
      лок»нт = »нтƒокументќѕроживании;
      –едактироватьƒокѕолучател€(лок»нт, “ипƒокѕолучѕроживание);
      »нтƒокументќѕроживании = лок»нт;
    else
      locValuePosition[1] = 'ќткрыть документ';
      locValuePosition[2] = '”далить документ';
      p = PopupMenu(locValuePosition);
      if (p = 1):
        лок»нт = »нтƒокументќѕроживании;
        –едактироватьƒокѕолучател€(лок»нт, “ипƒокѕолучѕроживание);
        »нтƒокументќѕроживании = лок»нт;
      elsif (p = 2):
        локƒокумент = »нтƒокументќѕроживании.Record;
        »нтƒокументќѕроживании = nil;
        локƒокумент.Delete;
      fi;
    fi;
  end;

  proc –едактироватьƒокѕолучател€ (var лок»нт: —правочники.инт”достоверение—оц—трах; лок“ипƒокумента: integer);
    var локƒокумент: Ѕазовый.—правочники.”достоверение;
    if (лок»нт = nil):
      лок»нт = —правочники.инт”достоверение—оц—трах.—оздатьѕо«а€вке»“ипу(Self.Record,лок“ипƒокумента);
    fi;
    локƒокумент = лок»нт.Record;
    —правочники.инт”достоверение—оц—трах.Ѕланк–едакторѕо”молчанию.ShowFormEx(локƒокумент , Kernel.Window.ModalWindow);
    локƒокумент = —правочники.инт”достоверение—оц—трах.Ќайтиƒокументѕо«а€вке»“ипу(Self.Record,лок“ипƒокумента);
    if (локƒокумент = nil):
      лок»нт = nil;
    else
      лок»нт.Record = локƒокумент;
    fi;
  end;

end