class inherited СИС2.БазовыйБланк "Ввод основных данных субъекта";


inobject private


var Получатель : Документы.Получатель;

var Фамилия : string;
var Имя : string;
var Отчество : string;
var Телефон : string;
var ДатаРождения : date;

inclass public

func CreateExt (локПолучатель : Документы.Получатель): Служебные.блОсновныеДанныеСубъекта;
  Result = Служебные.блОсновныеДанныеСубъекта.Create;
  Result.Получатель = локПолучатель;
end;

func OpenForm (локПолучатель : Документы.Получатель): integer;
  var locForm: Служебные.блОсновныеДанныеСубъекта;
  locForm = CreateExt (локПолучатель);
  if (CmOk = locForm.ShowEx( , Kernel.Window.ModalWindow)):
    Return CmOk;
  fi;
end;


inobject private


--------------------------------------------------------------------------------
--{ Обработчики событий бланка

proc шаблон_ПриОткрытии(Create :Logical);
  inherited шаблон_ПриОткрытии(Create);
  ПрочитатьПоля;
  --ВидФормы;
end;


--}


--{{ Обработчики событий прочих объектов шаблона

proc кнОк_ПриНажатии (Sender: Button);
  ЗаписатьПоля;
  inherited кнОк_ПриНажатии (Sender);
end;

--}}


--{{ Вспомогательные методы

proc ПрочитатьПоля;
 Фамилия = Получатель.Фамилия;
 Имя = Получатель.Имя;
 Отчество = Получатель.Отчество;
 Телефон = Получатель.Телефон;
 ДатаРождения = Получатель.ДатаРождения;
end;

proc ЗаписатьПоля;
 Получатель.ЗапомнитьФамилия(Фамилия);
 Получатель.ЗапомнитьИмя(Имя);
 Получатель.ЗапомнитьОтчество(Отчество);
 Получатель.ЗапомнитьТелефон(Телефон);
 Получатель.ЗапомнитьДатаРождения(ДатаРождения);
end;
--}

func Поле_ПриВыводе_ЗаголовокОкнаФормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
  var aTxt: string[];
  with СИС2.СтроковыеФункции  do
    aTxt[1] = MarkInGray(Получатель.Заявление.НашеУчреждение.Наим);
    aTxt[2] = 'Заявление на оплату пособия соц. страх. N '+Получатель.Заявление.НомерБум;
    if (Получатель.Заявление.Дата <> nil) :
      aTxt[2] = aTxt[2] + ' от '+Str(Получатель.Заявление.Дата);
    fi;
    if (Получатель.Заявление.Субъект <> nil) :
      aTxt[3] = MarkInGray(Получатель.Заявление.Субъект.Имя);
    else
      aTxt[3] = '<s-><s->' ;
    fi;
    Return МассивСтрокВТекст(aTxt);
  end;
end;


end