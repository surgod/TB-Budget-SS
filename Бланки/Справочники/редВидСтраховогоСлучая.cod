class inherited МашинаРеквизитов.Базовые.блРедакторСИнтерфейсом "Редактор вида страхового случая", editor Справочники.ВидСтраховогоСлучая;


import classes Константы,ФункцииПримененияКостант,ФункцииЭлементовДанных;


--{{ Свойства

inobject public

  var Интерфей : Справочники.интВидСтраховогоСлучая;

inobject private


var фреймФорма : TemplateFrame;

--}}




--{{ Обработчики событий шаблона

  proc шаблон_ПриСоздании(Context :Variant);
    inherited шаблон_ПриСоздании(Context);
    ОбновитьСписокПоля(фреймФорма.CellByField['ТипПособия'], ТипыПособий, 1, 2);
    ОбновитьСписокПоля(фреймФорма.CellByField['ТипУчастияФСС'], ТипыУчастияФСС, 1, 2);
    ОбновитьСписокПоля(фреймФорма.CellByField['ВидРасчетовС_ФСС'], ВидыРасчетовС_ФСС, 1, 2);
  end;


func ПолеПлюсМинус_ПриНажатии(Cell:TemplateCell; Action : Template.ClickTypes) : Logical;
  var nn : integer;
  var локВСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    Template.BeginModify;
      if (Cell.Contents = '+') :
        --if (CmOk = Справочники.картВидыСтраховогоОбеспеченияСС.ВыполнитьВыбор(локВСО)):
          --if (ТестВСО(локВСО)) :
            nn = Self.Record.ДопустимыеВСО.Add;
            Self.Record.ДопустимыеВСО[nn].ВидСО = локВСО;
          --fi;
        --fi;
      elsif (Cell.Contents = 'x') :
        nn = Cell.Frame;
        Self.Record.ДопустимыеВСО.Delete(nn);
      fi;
    Template.EndModify;
end;


func ПолеВСО_ПриВыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): string;
  var nn : integer;
  var локВСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
  Result = '';
  if (Cell.Contents = 'Закон') :
    nn = Cell.Frame;
    локВСО = Self.Record.ДопустимыеВСО[nn].ВидСО;
    локВСО = if (локВСО = nil : локВСО, локВСО.GroupDoc);
    return if(локВСО <> nil : локВСО.Имя, '');
  fi;
end;



--}}

--{{ Вспомогательные методы

func ТестВСО(локВСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения) : logical;
  var i : integer;
  var Note : string;
    Result = true;
    for i = 1..ДопустимыеВСО.Count do
      if (Self.Record.ДопустимыеВСО[i].ВидСО = локВСО) :
        Note = 'Такой вид страхового обеспечения уже есть.';
        Message(Note);
        return false;
      fi;
    end;
end;


--}}

  func Поле_ПриВыводе_ЗаголовокОкнаФормы (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): String;
    Result = if((Имя <> nil), Имя, 'Вид страхового случая');
  end;

end