class "‘ункции работы с запис€ми элементов данных";

import classes  онстанты;
import Ѕазовый classes  онстанты;
import —»—2 classes ‘ункции–““»;

inclass public

--@doc возвращает ссылку на запись последнего дл€ данного страхового случа€ получател€
func ѕолучательƒл€—трах—луча€ (лок—трах—лучай : ƒанные.—траховой—лучай) : ƒанные.ѕолучательѕособи€;
  Result = nil;
  with Query.Create([ƒанные.ѕолучательѕособи€]) do
    Filter = '—траховой—лучай = ' + Str(лок—трах—лучай);
    Order = '—четчик';
    Select;
    if (not EOF) :
      Last;
      Result = Current;
    fi;
  end;
end;



func «апись“ипјдреса (лок“ипјдреса : integer): Ѕазовый.—правочники.“ипјдреса;
  var лок‘ильтр : string;
    лок‘ильтр = " од='" + ѕредопределени€[лок“ипјдреса,1] +"'";
    Result = —»—2.‘ункцииƒокумента.QueryRecord(Ѕазовый.—правочники.“ипјдреса, лок‘ильтр);
end;

proc јдрес–егистрацииѕо”мол (локѕолучательѕособи€ : ƒанные.ѕолучательѕособи€);
  var локјдрес_‘Ћ,локјдрес—— : Ѕазовый.—правочники.јдрес;
  --var локјдрес—— : —правочники.јдрес—оц—трах;
  var лок‘изЋицо : Ѕазовый.ƒанные.—убъект;
  var лок«апись“ипјдреса  : Ѕазовый.—правочники.“ипјдреса;
  var i : integer;
    лок‘изЋицо = локѕолучательѕособи€.—убъект.‘изЋицо;
    локјдрес_‘Ћ = “ЅЅ_Ѕазовый.Ѕиблио.ѕолучитьјдрес—убъекта(лок‘изЋицо,Today);
    if (локјдрес_‘Ћ <> nil) :
      локјдрес—— = локјдрес_‘Ћ.Clone;
      локјдрес——.—убъект = nil;
      локјдрес——.ѕолучатель‘изЋицо = лок‘изЋицо;
      локјдрес——.ѕолучательѕособи€ = локѕолучательѕособи€;
      лок«апись“ипјдреса = «апись“ипјдреса (тапѕрописка);
      локјдрес——.ѕозиции.Clear;
      i = локјдрес——.ѕозиции.Add;
      локјдрес——.ѕозиции[i].“ипјдреса = лок«апись“ипјдреса;
      локјдрес——.Post;
    fi;
end;

proc ”дЋичностиѕо”мол (локѕолучательѕособи€ : ƒанные.ѕолучательѕособи€);
  var лок”достоверение‘Ћ,лок”достоверение—— : Ѕазовый.—правочники.”достоверение;
  var лок‘изЋицо : Ѕазовый.ƒанные.—убъект;
  var i : integer;
    лок‘изЋицо = локѕолучательѕособи€.—убъект.‘изЋицо;
    лок”достоверение‘Ћ = “ЅЅ_Ѕазовый.Ѕиблио.ѕолучитьƒокумент—убъекта(лок‘изЋицо,Today);
    if (лок”достоверение‘Ћ <> nil) :
      лок”достоверение—— = лок”достоверение‘Ћ.Clone;
      лок”достоверение——.‘изЋицо = nil;
      лок”достоверение——.ѕолучатель‘изЋицо = лок‘изЋицо;
      лок”достоверение——.ѕолучательѕособи€ = локѕолучательѕособи€;
      лок”достоверение——.“ипƒокумента—оц—трах = “ипƒокѕолуч”дЋичн;
      лок”достоверение——.Post;
    fi;
end;



end