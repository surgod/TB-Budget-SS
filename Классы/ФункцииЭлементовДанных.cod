class "Функции работы с записями элементов данных";

import classes Константы;
import Базовый classes Константы;


inclass public

--@doc возвращает ссылку на запись последнего для данного страхового случая получателя
func ПолучательДляСтрахСлучая (локСтрахСлучай : Данные.СтраховойСлучай) : Данные.ПолучательПособия;
  Result = nil;
  with Query.Create([Данные.ПолучательПособия]) do
    Filter = 'СтраховойСлучай = ' + Str(локСтрахСлучай);
    Order = 'НомерДляСтрахСлучая';
    Select;
    if (not EOF) :
      Last;
      Result = Current;
    fi;
  end;
end;

--@doc возвращает ссылку на запись адреса получателя по типу адреса
func АдресПолучателяПоТипу (локПолучательПособия : Данные.ПолучательПособия; локТипАдреса : integer) : Базовый.Справочники.Адрес;
  var aFlt: string[];
    Result = nil;
    aFlt[1] = 'ПолучательПособия=' + Str(локПолучательПособия);
    if (локТипАдреса = тапПрописка) :
      aFlt[2] = 'ЭтоАдресРегистрации';
    else
      aFlt[2] = 'ЭтоАдресПроживания';
    fi;
    with Query.Create([Базовый.Справочники.Адрес]) do
      Filter = СИС2.СтроковыеФункции.СложитьСтрокиФильтраПоИ(aFlt);
      Select;
      if (not EOF) :
        Result = Current;
      fi;
    end;
end;


end