class inherited ТББ_Базовый.Базовые.картДокумент "Заявления на оплату пособий соц.страх.";

import classes Константы;


inclass private

  var ПолеСтолбцаНаше: String:= 'НашеУчреждение.Имя';
  var ТипРеестра : integer = ТипРеестраБЛ;
  var КлассИнтерфейса: Class МашинаРеквизитов.Базовые.интЗапись = Документы.интЗаявление;

  --тип реестра пока задан жестко

--------------------------------------------------------------------------------
--{ Обработчики событий картотеки
inobject private

  func картотека_ПриСозданииЗаписи (var locRecord: Документы.Первичные.Заявление): Logical;
    var локВсеНашиУчреждения: Базовый.Данные.Субъект[];
    var локНашеУчреждение: Базовый.Данные.Субъект;
    if (НашеУчреждение = nil): -- определение учреждения документа и возможности выбора учреждения
      локВсеНашиУчреждения = ТББ_Базовый.Библио.ВсеНашиУчреждения;
      if (LengthOfArray(локВсеНашиУчреждения) = 1):
        ДобавитьПараметрНовойЗаписи('НашеУчреждение', локВсеНашиУчреждения[1]);
      else
        if (CmOk = ТББ_Базовый.Библио.ВыборНашегоУчреждения(локНашеУчреждение)):
          ДобавитьПараметрНовойЗаписи('НашеУчреждение', локНашеУчреждение);
        else
          Return;
        fi;
      fi;
    else
      ДобавитьПараметрНовойЗаписи('НашеУчреждение', НашеУчреждение);
    fi;
    ДобавитьПараметрНовойЗаписи('НаимТОФСС', НашеУчреждение.НаимОрганаФСС);
    ДобавитьПараметрНовойЗаписи('ТипРеестра', ТипРеестра);
    ДобавитьПараметрНовойЗаписи('Дата', ToDay);
    if inherited картотека_ПриСозданииЗаписи(locRecord):
      КлассИнтерфейса.БланкРедакторПоУмолчанию.ShowFormEx(locRecord);
    fi;
  end;
--}

end