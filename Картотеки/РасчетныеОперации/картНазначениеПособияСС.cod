class inherited СИС2.КартБазовая "картотека назначений пособий";

import classes Константы;

inobject private


func КартПоле_ПриВыводе (Column: CardfileColumn; Rec: Бюджет_ЗПиДД.РасчетныеОперации.НазначениеПособия; Action: Template.OutputTypes; var Format: String): Variant;
  var локВидСО : Бюджет_ЗПиДД.Справочники.ВидыСтраховогоОбеспечения;
    Result = '';
    локВидСО = Rec.ВидСтраховогоОбеспечения;
    Result = ИмяТипаПособия(локВидСО.ТипПособия);
end;



inclass public

func ВыполнитьВыбор (var локРезультатВыбора: Бюджет_ЗПиДД.РасчетныеОперации.НазначениеПособия;
                     локНашеУчреждение: Базовый.Данные.Субъект;
                     локСотрудник : Базовый.Данные.Субъект;
                     локПособиеДоп : logical = false): Integer;
  var locCrd: РасчетныеОперации.картНазначениеПособияСС;
  var locResult: Бюджет_ЗПиДД.РасчетныеОперации.НазначениеПособия;
  var aFlt[] : string;
    aFlt[1] = 'НашеУчреждение=' + Str(локНашеУчреждение);
    aFlt[2] = 'Сотрудник=' + Str(локСотрудник);
    if (локПособиеДоп) :
      aFlt[3] = 'ВидСтраховогоОбеспечения.ТипПособия=' + Str(ТипПособияРанСрок);
    else
      aFlt[3] = 'ВидСтраховогоОбеспечения.ТипПособия<>' + Str(ТипПособияНет);
    fi;
    locResult = локРезультатВыбора;
    locCrd = РасчетныеОперации.картНазначениеПособияСС.Create;
    locCrd.CardFile.UserFilter = СИС2.СтроковыеФункции.СложитьСтрокиФильтраПоИ(aFlt);
    if (CmOk = locCrd.ShowEx(locResult, , Kernel.Window.ModalWindow)):
      локРезультатВыбора = locResult;
      Return CmOk;
    fi;
end;

end